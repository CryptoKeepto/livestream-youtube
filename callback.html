<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Callback</title>
  </head>
  <body>
    <h1>Callback</h1>
    <a href="http://cryptokeepto.com/index.html">go back</a>
    <script>
      // get accessToken
      const value = window.location.hash.substring(1);
      const searchParams = new URLSearchParams(value);
      if (searchParams.has("error")) {
        const message = searchParams.get("error");
        alert(message);
        throw new Error(message);
      }
      if (searchParams.has("access_token")) {
        const accessToken = searchParams.get("access_token");
        const date = new Date();
        const tomorrow = date.setDate(date.getDate() + 1);

        // save accessToken in cookie
        document.cookie = `accessToken=${accessToken}; expires=${new Date(
          tomorrow
        ).toUTCString()};`;
      }
    </script>
  </body>
</html>
